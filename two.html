<html>
<head>
<title>Human Capabilities - Reaction test</title> </head>
<body>

<table width = "50%" align = "center"><tr valign = "center"><td>
<h1><p id="text">Exercise D.2</p></h1>
<p id="instruction">Instructions will be shown here.</p>
<canvas id="myCanvas" width="600" height="450"></canvas>
<p>
<p id="time"></p> <p id="count"></p> <p id="mean"></p> <p id="sd"></p> </td></tr></table>

<script src = "experiment.js"> </script>

<script type="text/javascript">
	var STIMULUS_CIRCLE = 0;
	var STIMULUS_RECTANGLE = 1;
	var currentStimulus = -1;
	var canvas = document.getElementById('myCanvas');
	var context = canvas.getContext('2d');
	
	function showSimpleStimulus() {
		var rnd = Math.random() * 100;
		if (rnd > 50) {
			context = canvas.getContext('2d');
		  var radius = Math.random() * 100 + 75;
		  
		  var safeWidth = canvas.width - radius*2;
		  var safeHeight = canvas.height - radius*2;
		  var centerX = Math.random() * safeHeight  + radius;
		  var centerY = Math.random() * safeHeight  + radius;
		  
		  currentStimulus = STIMULUS_CIRCLE;
		  context.beginPath();
		  context.arc(centerX, centerY, radius, 0, 2 * Math.PI, false);
		  context.fillStyle = 'green';
		  context.fill();
		  context.lineWidth = 5;
		  context.strokeStyle = '#003300';
		  context.stroke();
		  context.closePath();
		} else {
			context = canvas.getContext('2d');
			
			
			context.fillStyle = "rgba(255, 255, 255, 1)";
			context.fillRect(0, 0, canvas.width, canvas.height);
		    currentStimulus = STIMULUS_RECTANGLE;
		  context.beginPath();
		  var sideLength = Math.random() * 200 + 150;
		  var safeWidth = canvas.width - sideLength;
		  var safeHeight = canvas.height - sideLength;
		  var centerX = Math.random() * safeWidth;
		  var centerY = Math.random() * safeHeight ;
		  
		  context.rect(centerX,centerY,sideLength,sideLength);
		  context.fillStyle = 'green';
		  context.fill();
		  context.lineWidth = 5;
		  context.strokeStyle = '#003300';
		  context.stroke();
		}
		currentExperiment.currentStimulus = 0;
		testActive = true;
		return currentStimulus == STIMULUS_RECTANGLE;
	}

	function clearSimpleStimulus() {
		context.fillStyle = "rgba(255, 255, 255, 1)";
		context.fillRect(0, 0, canvas.width, canvas.height);
	}

	function onKey(e) { 
		if (e == null) {
			e = window.event;
		}
		switch (e.which || e.charCode || e.keyCode) {
			case 32:
			// space
			if (!currentExperiment.experimentActive) {
				currentExperiment.startExperiment(); 
			} else {
				if (currentStimulus == STIMULUS_RECTANGLE && testActive) {
				  currentExperiment.stopTest();
				} else {
				  currentExperiment.reportError();
				}
			}
			break;
			case 27: // esc
			if (currentExperiment.experimentActive) {
				currentExperiment.stopExperiment();
			}
			break;/*
			case 65:
			  if (testActive) {
				if (currentStimulus == STIMULUS_CIRCLE) {
				  currentExperiment.stopTest();
				} else {
				  currentExperiment.reportError();
				}
			  } else {
				currentExperiment.reportError();
			  }
			  break;
			case 66:
			 if (testActive) {
				if (currentStimulus == STIMULUS_RECTANGLE) {
				  currentExperiment.stopTest();
				} else {
				  currentExperiment.reportError();
				}
			  } else {
				currentExperiment.reportError();
			  }
			  break;*/
		}
	}

	currentExperiment = new experiment(2, 
	"You will be requested to press SPACE only upon seeing a SQUARE. Please IGNORE any CIRCLEs.<br />" +
	"Press SPACE BAR to begin.", 
	"Press SPACE BAR when you see a SQUARE.", 
	showSimpleStimulus, clearSimpleStimulus, onKey, 25, ["Binary Stimulus"]);
</script>
</body>
</html>
